<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cherokee Chooters Shred - Weight Tracker</title>
    
    <!-- Firebase v8 -->
    <script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            background: linear-gradient(to bottom right, #eff6ff, #e0e7ff);
            min-height: 100vh;
            padding: 2rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        h1 {
            font-size: 3rem;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .subtitle {
            color: #6b7280;
            font-size: 1.1rem;
        }
        
        .stats {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin: 2rem 0;
        }
        
        .stat-card {
            background: white;
            padding: 1.5rem 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
            min-width: 200px;
        }
        
        .stat-card.cruise {
            background: linear-gradient(to right, #06b6d4, #2563eb);
            color: white;
        }
        
        .stat-card.total {
            background: linear-gradient(to right, #6366f1, #a855f7);
            color: white;
        }
        
        .stat-card.leader {
            background: linear-gradient(to right, #fbbf24, #f97316);
            color: white;
        }
        
        .stat-card.leader-pct {
            background: linear-gradient(to right, #4ade80, #10b981);
            color: white;
        }
        
        .stat-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
        }
        
        .stat-subtext {
            font-size: 0.9rem;
            margin-top: 0.25rem;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .person-card {
            background: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .person-name {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .input-group {
            margin-bottom: 1rem;
        }
        
        label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        
        .input-row {
            display: flex;
            gap: 0.5rem;
        }
        
        input, select {
            flex: 1;
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.375rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-add {
            background: #6366f1;
            color: white;
        }
        
        .btn-add:hover {
            background: #4f46e5;
        }
        
        .btn-goal {
            background: #10b981;
            color: white;
        }
        
        .btn-goal:hover {
            background: #059669;
        }
        
        .btn-delete {
            background: #ef4444;
            color: white;
            font-size: 0.875rem;
            padding: 0.25rem 0.75rem;
        }
        
        .btn-delete:hover {
            background: #dc2626;
        }
        
        .person-stats {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb;
        }
        
        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .stat-text {
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .progress {
            font-weight: 600;
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }
        
        .loading {
            text-align: center;
            padding: 4rem;
            font-size: 1.5rem;
            color: #6b7280;
        }
        
        .error {
            text-align: center;
            padding: 2rem;
            color: #ef4444;
            background: #fee;
            border-radius: 0.5rem;
            margin: 2rem;
        }
        
        .chart-container {
            background: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .chart-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        
        .chart-wrapper {
            position: relative;
            height: 400px;
            width: 100%;
        }
        
        .table-container {
            background: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            overflow-x: auto;
        }
        
        .table-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .btn-download {
            background: #10b981;
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.375rem;
            font-weight: 500;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s;
        }
        
        .btn-download:hover {
            background: #059669;
        }
        
        .goal-celebration {
            display: inline-block;
            margin-left: 0.5rem;
            font-size: 1.5rem;
            animation: bounce 1s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: #f3f4f6;
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
        }
        
        td {
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        tr:hover {
            background: #f9fafb;
        }
        
        .name-cell {
            font-weight: 600;
        }
        
        .message-board {
            background: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-top: 2rem;
        }
        
        .message-board-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        
        .message-input-area {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .message-select {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
            background: white;
        }
        
        .message-input {
            flex: 1;
            min-width: 200px;
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
        }
        
        .btn-post {
            background: #6366f1;
            color: white;
            padding: 0.5rem 1.5rem;
            border: none;
            border-radius: 0.375rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-post:hover {
            background: #4f46e5;
        }
        
        .messages-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .retroactive-entry {
            background: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-top: 2rem;
        }
        
        .retroactive-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        
        .retroactive-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            align-items: end;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        
        .form-input {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
        }
        
        .btn-add-retroactive {
            background: #8b5cf6;
            color: white;
            padding: 0.5rem 1.5rem;
            border: none;
            border-radius: 0.375rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            height: fit-content;
        }
        
        .btn-add-retroactive:hover {
            background: #7c3aed;
        }
        
        .message-item {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            transition: background 0.2s;
        }
        
        .message-item:hover {
            background: #f9fafb;
        }
        
        .message-item:last-child {
            border-bottom: none;
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .message-author {
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .message-time {
            font-size: 0.75rem;
            color: #6b7280;
        }
        
        .message-text {
            color: #374151;
            line-height: 1.5;
        }
        
        .btn-delete-message {
            background: #ef4444;
            color: white;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border: none;
            border-radius: 0.25rem;
            cursor: pointer;
            margin-left: 0.5rem;
        }
        
        .btn-delete-message:hover {
            background: #dc2626;
        }
        
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #f0f;
            animation: confetti-fall 3s linear forwards;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .stats {
                flex-direction: column;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
            
            .chart-wrapper {
                height: 300px;
            }
            
            .chart-title {
                font-size: 1.25rem;
            }
            
            .chart-container {
                padding: 1rem;
            }
            
            th, td {
                padding: 0.5rem;
                font-size: 0.875rem;
            }
            
            .table-title {
                font-size: 1.25rem;
            }
            
            .message-board-title {
                font-size: 1.25rem;
            }
            
            .message-input-area {
                flex-direction: column;
            }
            
            .message-select, .message-input {
                width: 100%;
            }
            
            .retroactive-title {
                font-size: 1.25rem;
            }
            
            .retroactive-form {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="loading">Loading Firebase...</div>
    </div>

    <script>
        const inspirationalQuotes = [
            "The only bad workout is the one that didn't happen.",
            "Your body can stand almost anything. It's your mind you have to convince.",
            "Success is the sum of small efforts repeated day in and day out.",
            "The difference between try and triumph is a little umph.",
            "Don't wish for it, work for it.",
            "Strive for progress, not perfection.",
            "The body achieves what the mind believes.",
            "You don't have to be extreme, just consistent.",
            "Every journey begins with a single step.",
            "Champions keep playing until they get it right.",
            "The pain you feel today will be the strength you feel tomorrow.",
            "Believe in yourself and all that you are.",
            "Push yourself because no one else is going to do it for you.",
            "Great things never come from comfort zones.",
            "Wake up with determination. Go to bed with satisfaction.",
            "Your only limit is you.",
            "It's going to be hard, but hard does not mean impossible.",
            "Fall in love with taking care of yourself.",
            "Small progress is still progress.",
            "You are stronger than you think.",
            "Make yourself proud.",
            "The only person you should try to be better than is the person you were yesterday.",
            "Don't stop when you're tired. Stop when you're done.",
            "You're one workout away from a good mood.",
            "Take care of your body. It's the only place you have to live.",
            "The secret of getting ahead is getting started.",
            "Motivation is what gets you started. Habit is what keeps you going.",
            "Be stronger than your excuses.",
            "Success starts with self-discipline.",
            "Doubt kills more dreams than failure ever will.",
            "The harder you work for something, the greater you'll feel when you achieve it.",
            "Dream bigger. Do bigger.",
            "Don't wait for opportunity. Create it.",
            "Sometimes later becomes never. Do it now.",
            "Sweat is magic. Cover yourself in it daily to grant your wishes.",
            "If it doesn't challenge you, it won't change you.",
            "Making excuses burns zero calories per hour.",
            "You miss 100% of the shots you don't take.",
            "A one hour workout is only 4% of your day.",
            "The only way to finish is to start.",
            "Transformation is not a future event. It's a present activity.",
            "Your health is an investment, not an expense.",
            "Fitness is not about being better than someone else. It's about being better than you used to be.",
            "The groundwork for all happiness is good health.",
            "Take care of yourself. You deserve it.",
            "Progress, not perfection.",
            "Every accomplishment starts with the decision to try.",
            "The best project you'll ever work on is you.",
            "Good things come to those who sweat.",
            "Train like a beast, look like a beauty.",
            "Excuses don't burn calories.",
            "Your body hears everything your mind says. Stay positive.",
            "Eat clean, train dirty.",
            "Strong is the new skinny.",
            "Wake up. Work out. Look hot. Kick ass.",
            "The only bad decision is not making one.",
            "Sore today, strong tomorrow.",
            "No pain, no gain. Shut up and train.",
            "When you feel like quitting, think about why you started.",
            "Discipline is doing what needs to be done, even when you don't want to do it.",
            "The difference between who you are and who you want to be is what you do.",
            "It's a slow process, but quitting won't speed it up.",
            "You don't get what you wish for. You get what you work for.",
            "Results happen over time, not overnight. Work hard, stay consistent, and be patient.",
            "Your future self will thank you.",
            "Commit to be fit.",
            "Fitness is like a relationship. You can't cheat and expect it to work.",
            "Train insane or remain the same.",
            "The pain of discipline weighs ounces. The pain of regret weighs tons.",
            "Whether you think you can or think you can't, you're right."
        ];
        
        function checkFirebase() {
            if (typeof firebase !== 'undefined') {
                console.log('Firebase loaded!');
                initApp();
            } else {
                console.log('Waiting for Firebase...');
                setTimeout(checkFirebase, 100);
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', checkFirebase);
        } else {
            checkFirebase();
        }

        function initApp() {
            const firebaseConfig = {
                apiKey: "AIzaSyBpcOAWrr8hV2LQ2_mIUfIgvs05y2AYTRY",
                authDomain: "cherokee-chooters-shred.firebaseapp.com",
                projectId: "cherokee-chooters-shred",
                storageBucket: "cherokee-chooters-shred.firebasestorage.app",
                messagingSenderId: "448611335080",
                appId: "1:448611335080:web:eb9eb0688d9b846e0cbb9d"
            };

            console.log('Initializing Firebase...');
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
            console.log('Firebase initialized!');

            const people = ['Adam', 'Sean', 'Daniel', 'Mark'];
            const colors = {
                Adam: '#3b82f6',
                Sean: '#ef4444',
                Daniel: '#10b981',
                Mark: '#f59e0b'
            };

            let weights = { Adam: [], Sean: [], Daniel: [], Mark: [] };
            let goals = { Adam: null, Sean: null, Daniel: null, Mark: null };
            let loaded = false;
            let chart = null;
            let messages = [];

            console.log('Setting up listeners...');
            
            db.collection('weights').onSnapshot((snapshot) => {
                console.log('Weights snapshot received, docs:', snapshot.size);
                weights = { Adam: [], Sean: [], Daniel: [], Mark: [] };
                
                snapshot.forEach((doc) => {
                    const data = doc.data();
                    if (weights[data.person] !== undefined) {
                        weights[data.person].push({
                            id: doc.id,
                            timestamp: data.timestamp,
                            weight: data.weight
                        });
                    }
                });

                Object.keys(weights).forEach(person => {
                    weights[person].sort((a, b) => a.timestamp - b.timestamp);
                });

                loaded = true;
                render();
            }, (error) => {
                console.error('Error loading weights:', error);
                document.getElementById('root').innerHTML = `
                    <div class="error">
                        <h2>Error Loading Data</h2>
                        <p>${error.message}</p>
                    </div>
                `;
            });

            db.collection('goals').onSnapshot((snapshot) => {
                console.log('Goals snapshot received, docs:', snapshot.size);
                goals = { Adam: null, Sean: null, Daniel: null, Mark: null };
                
                snapshot.forEach((doc) => {
                    const data = doc.data();
                    goals[data.person] = data.goal;
                });

                if (loaded) render();
            }, (error) => {
                console.error('Error loading goals:', error);
            });

            db.collection('messages').orderBy('timestamp', 'desc').limit(20).onSnapshot((snapshot) => {
                console.log('Messages snapshot received, docs:', snapshot.size);
                messages = [];
                
                snapshot.forEach((doc) => {
                    const data = doc.data();
                    messages.push({
                        id: doc.id,
                        person: data.person,
                        message: data.message,
                        timestamp: data.timestamp
                    });
                });

                if (loaded) render();
            }, (error) => {
                console.error('Error loading messages:', error);
            });

            window.addWeight = async function(person) {
                const input = document.getElementById(`weight-${person}`);
                const weight = parseFloat(input.value);
                
                if (isNaN(weight) || weight <= 0) {
                    alert('Please enter a valid weight');
                    return;
                }

                // Check if goal achieved
                const goalAchieved = goals[person] && weight <= goals[person] && 
                    (weights[person].length === 0 || weights[person][weights[person].length - 1].weight > goals[person]);

                try {
                    await db.collection('weights').add({
                        person: person,
                        weight: weight,
                        timestamp: Date.now()
                    });
                    input.value = '';
                    
                    // Celebrate if goal achieved
                    if (goalAchieved) {
                        celebrate();
                    }
                } catch (error) {
                    console.error('Error adding weight:', error);
                    alert('Error saving weight: ' + error.message);
                }
            }

            window.setGoal = async function(person) {
                const input = document.getElementById(`goal-${person}`);
                const goal = parseFloat(input.value);
                
                if (isNaN(goal) || goal <= 0) {
                    alert('Please enter a valid goal');
                    return;
                }

                try {
                    const goalQuery = await db.collection('goals')
                        .where('person', '==', person)
                        .get();

                    if (goalQuery.empty) {
                        await db.collection('goals').add({
                            person: person,
                            goal: goal
                        });
                    } else {
                        await db.collection('goals').doc(goalQuery.docs[0].id).update({
                            goal: goal
                        });
                    }
                    input.value = '';
                } catch (error) {
                    console.error('Error setting goal:', error);
                    alert('Error saving goal: ' + error.message);
                }
            }

            window.deleteLastWeight = async function(person) {
                if (weights[person].length === 0) return;
                
                const lastEntry = weights[person][weights[person].length - 1];
                
                if (!confirm(`Delete last weight entry (${lastEntry.weight} lbs)?`)) {
                    return;
                }
                
                try {
                    await db.collection('weights').doc(lastEntry.id).delete();
                } catch (error) {
                    console.error('Error deleting weight:', error);
                    alert('Error deleting weight: ' + error.message);
                }
            }

            function getWeightLoss(person) {
                if (weights[person].length < 2) return 0;
                return weights[person][0].weight - weights[person][weights[person].length - 1].weight;
            }

            function getWeightLossPercentage(person) {
                if (weights[person].length < 2) return 0;
                const loss = getWeightLoss(person);
                return (loss / weights[person][0].weight) * 100;
            }

            function getTotalWeightLoss() {
                return people.reduce((total, person) => total + getWeightLoss(person), 0);
            }

            function getDaysUntilCruise() {
                const cruiseDate = new Date('2026-02-27');
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                cruiseDate.setHours(0, 0, 0, 0);
                return Math.ceil((cruiseDate - today) / (1000 * 60 * 60 * 24));
            }

            function getLeaderByPounds() {
                let leader = null;
                let maxLoss = 0;
                
                people.forEach(person => {
                    const loss = getWeightLoss(person);
                    if (loss > maxLoss) {
                        maxLoss = loss;
                        leader = person;
                    }
                });
                
                return leader ? { name: leader, loss: maxLoss } : null;
            }

            function getLeaderByPercentage() {
                let leader = null;
                let maxPercentage = 0;
                
                people.forEach(person => {
                    const percentage = getWeightLossPercentage(person);
                    if (percentage > maxPercentage) {
                        maxPercentage = percentage;
                        leader = person;
                    }
                });
                
                return leader ? { name: leader, percentage: maxPercentage } : null;
            }

            function formatLastEntry(timestamp) {
                const date = new Date(timestamp);
                const today = new Date();
                const yesterday = new Date(today);
                yesterday.setDate(yesterday.getDate() - 1);

                const dateStr = date.toLocaleDateString();
                const todayStr = today.toLocaleDateString();
                const yesterdayStr = yesterday.toLocaleDateString();

                const timeStr = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

                if (dateStr === todayStr) {
                    return `Today at ${timeStr}`;
                }
                return `${date.toLocaleDateString()} at ${timeStr}`;
            }

            function getAllEntries() {
                const allEntries = [];
                people.forEach(person => {
                    weights[person].forEach(entry => {
                        allEntries.push({
                            person: person,
                            weight: entry.weight,
                            timestamp: entry.timestamp
                        });
                    });
                });
                allEntries.sort((a, b) => b.timestamp - a.timestamp);
                return allEntries;
            }

            function formatTimestamp(timestamp) {
                const date = new Date(timestamp);
                const dateStr = date.toLocaleDateString();
                const timeStr = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                return `${dateStr} ${timeStr}`;
            }

            function hasMetGoal(person) {
                if (!goals[person] || weights[person].length === 0) return false;
                const currentWeight = weights[person][weights[person].length - 1].weight;
                return currentWeight <= goals[person];
            }

            function downloadCSV() {
                const entries = getAllEntries();
                
                let csv = 'Name,Weight (lbs),Timestamp\n';
                
                entries.forEach(entry => {
                    csv += `${entry.person},${entry.weight},${formatTimestamp(entry.timestamp)}\n`;
                });
                
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `cherokee-chooters-weight-history-${new Date().toISOString().split('T')[0]}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            }

            window.downloadCSV = downloadCSV;

            function getDailyQuote() {
                const dayOfYear = Math.floor((Date.now() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);
                return inspirationalQuotes[dayOfYear % inspirationalQuotes.length];
            }

            window.postMessage = async function() {
                const personSelect = document.getElementById('messagePerson');
                const messageInput = document.getElementById('messageInput');
                
                const person = personSelect.value;
                const message = messageInput.value.trim();
                
                if (!message) {
                    alert('Please enter a message');
                    return;
                }

                try {
                    await db.collection('messages').add({
                        person: person,
